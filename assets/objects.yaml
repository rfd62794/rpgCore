# Archetype-Based Object Manifest
# ADR 082: The Archetype Manifest Protocol
# Using YAML Anchors for Material Inheritance

# === MATERIAL ARCHETYPES (Defined Once) ===

# Wood Base Archetype
wood_base: &wood_base
  characteristics:
    material: "wood"
    tags: ["flammable", "organic", "wooden"]
    resistances: ["blunt"]
    weaknesses: ["fire", "sharp"]
    interaction_hooks: ["examine"]  # Default for all objects
  collision: true
  friction: 0.4
  metadata:
    burn_temperature: 300
    decay_rate: 0.1

# Stone Base Archetype
stone_base: &stone_base
  characteristics:
    material: "stone"
    tags: ["heavy", "durable", "mineral"]
    resistances: ["blunt", "sharp", "fire"]
    weaknesses: ["acid", "magic"]
    interaction_hooks: ["examine"]
  collision: true
  friction: 0.8
  metadata:
    erosion_resistance: 0.9
    structural_integrity: 1.0

# Metal Base Archetype
metal_base: &metal_base
  characteristics:
    material: "metal"
    tags: ["conductive", "durable", "refined"]
    resistances: ["blunt", "sharp"]
    weaknesses: ["acid", "rust", "magic"]
    interaction_hooks: ["examine"]
  collision: true
  friction: 0.6
  metadata:
    rust_rate: 0.05
    conductivity: 1.0

# Organic Base Archetype
organic_base: &organic_base
  characteristics:
    material: "organic"
    tags: ["flammable", "decomposable", "natural"]
    resistances: []
    weaknesses: ["fire", "disease", "rot"]
    interaction_hooks: ["examine", "touch"]
  collision: false
  friction: 0.2
  metadata:
    decay_rate: 0.2
    growth_potential: 0.1

# Liquid Base Archetype
liquid_base: &liquid_base
  characteristics:
    material: "liquid"
    tags: ["fluid", "wet", "passable"]
    resistances: []
    weaknesses: ["evaporation", "absorption"]
    interaction_hooks: ["examine", "touch", "drink"]
  collision: false
  friction: 0.1
  metadata:
    viscosity: 1.0
    evaporation_rate: 0.01

# === CORE OBJECTS (Inheriting from Archetypes) ===

# Wooden Objects
wooden_door:
  <<: *wood_base
  characteristics:
    <<: *wood_base.characteristics
    state: "closed"
    integrity: 75
    triggers:
      on_open: "unlock_required"
      on_break: "splinter_effect"
    d20_checks:
      lockpick: {"difficulty": 15, "skill": "thievery", "success": "unlock_door"}
      force: {"difficulty": 12, "skill": "strength", "success": "break_door"}
  sprite_id: "door_wood"
  metadata:
    <<: *wood_base.metadata
    lock_complexity: "medium"

wooden_chest:
  <<: *wood_base
  characteristics:
    <<: *wood_base.characteristics
    state: "locked"
    integrity: 60
    triggers:
      on_open: "loot_release"
      on_break: "item_destruction"
    d20_checks:
      lockpick: {"difficulty": 18, "skill": "thievery", "success": "unlock_chest"}
      force: {"difficulty": 14, "skill": "strength", "success": "smash_chest"}
  sprite_id: "chest_wood"
  metadata:
    <<: *wood_base.metadata
    loot_tier: "common"

signpost:
  <<: *wood_base
  characteristics:
    <<: *wood_base.characteristics
    state: "weathered"
    integrity: 70
    interaction_hooks: ["examine", "read"]
    d20_checks:
      read: {"difficulty": 5, "skill": "literacy", "success": "read_sign"}
  sprite_id: "sign_wood"
  metadata:
    <<: *wood_base.metadata
    weathering: "moderate"

# Stone Objects
stone_wall:
  <<: *stone_base
  characteristics:
    <<: *stone_base.characteristics
    state: "intact"
    integrity: 150
    triggers:
      on_break: "collapse_effect"
    d20_checks:
      climb: {"difficulty": 20, "skill": "athletics", "success": "climb_wall"}
      break: {"difficulty": 25, "skill": "strength", "success": "break_wall"}
  sprite_id: "wall_stone"
  metadata:
    <<: *stone_base.metadata
    structural: true

crystal:
  <<: *stone_base
  characteristics:
    <<: *stone_base.characteristics
    material: "crystal"
    tags: ["magical", "resonant", "fragile"]
    state: "pristine"
    integrity: 40
    triggers:
      on_touch: "magical_resonance"
      on_break: "shard_explosion"
    d20_checks:
      examine: {"difficulty": 10, "skill": "arcana", "success": "detect_magic"}
      harvest: {"difficulty": 15, "skill": "mining", "success": "extract_crystal"}
  sprite_id: "crystal"
  metadata:
    <<: *stone_base.metadata
    magical_resonance: 0.8
    fragility: "high"

# Metal Objects
iron_chest:
  <<: *metal_base
  characteristics:
    <<: *metal_base.characteristics
    material: "iron"
    state: "locked"
    integrity: 120
    triggers:
      on_open: "loot_release"
      on_break: "metal_fragmentation"
    d20_checks:
      lockpick: {"difficulty": 20, "skill": "thievery", "success": "unlock_chest"}
      force: {"difficulty": 18, "skill": "strength", "success": "smash_chest"}
  sprite_id: "chest_iron"
  metadata:
    <<: *metal_base.metadata
    loot_tier: "uncommon"
    lock_complexity: "high"

metal_door:
  <<: *metal_base
  characteristics:
    <<: *metal_base.characteristics
    material: "iron"
    state: "sealed"
    integrity: 100
    triggers:
      on_open: "mechanism_required"
      on_break: "metal_fragmentation"
    d20_checks:
      force: {"difficulty": 22, "skill": "strength", "success": "bend_door"}
      mechanics: {"difficulty": 18, "skill": "tinkering", "success": "open_mechanism"}
  sprite_id: "door_metal"
  metadata:
    <<: *metal_base.metadata
    seal_type: "mechanical"

# Organic Objects
tree:
  <<: *organic_base
  characteristics:
    <<: *organic_base.characteristics
    material: "wood"
    tags: ["flammable", "organic", "wooden", "tall"]
    state: "healthy"
    integrity: 80
    triggers:
      on_chop: "wood_harvest"
      on_burn: "ash_production"
    d20_checks:
      climb: {"difficulty": 12, "skill": "athletics", "success": "climb_tree"}
      chop: {"difficulty": 10, "skill": "woodcutting", "success": "harvest_wood"}
  sprite_id: "tree"
  metadata:
    <<: *organic_base.metadata
    wood_yield: 5
    height: "tall"

bush:
  <<: *organic_base
  characteristics:
    <<: *organic_base.characteristics
    material: "plant_matter"
    tags: ["flammable", "organic", "small"]
    state: "flowering"
    integrity: 20
    triggers:
      on_gather: "berry_harvest"
      on_burn: "quick_ash"
    d20_checks:
      gather: {"difficulty": 5, "skill": "foraging", "success": "harvest_berries"}
      hide: {"difficulty": 8, "skill": "stealth", "success": "hide_in_bush"}
  sprite_id: "bush"
  metadata:
    <<: *organic_base.metadata
    berry_type: "wild"
    concealment: "moderate"

# Liquid Objects
water_puddle:
  <<: *liquid_base
  characteristics:
    <<: *liquid_base.characteristics
    material: "water"
    tags: ["fluid", "wet", "passable", "clean"]
    state: "fresh"
    integrity: 100
    triggers:
      on_drink: "hydration"
      on_touch: "wet_effect"
    d20_checks:
      drink: {"difficulty": 3, "skill": "survival", "success": "safe_drink"}
      examine: {"difficulty": 5, "skill": "nature", "success": "check_purity"}
  sprite_id: "water"
  metadata:
    <<: *liquid_base.metadata
    purity: "fresh"
    depth: "shallow"

# Special Objects (Minimal DNA)
ancient_ruins:
  characteristics:
    material: "ancient_stone"
    tags: ["ancient", "mysterious", "structural"]
    state: "crumbling"
    integrity: 200
    triggers:
      on_examine: "lore_discovery"
      on_touch: "ancient_magic"
    d20_checks:
      examine: {"difficulty": 15, "skill": "history", "success": "read_ruins"}
      explore: {"difficulty": 18, "skill": "investigation", "success": "find_secret"}
  collision: true
  friction: 0.7
  sprite_id: "ruins"
  metadata:
    age: "ancient"
    mystery_level: "high"

# Combat Objects (Streamlined)
forest_guardian:
  characteristics:
    material: "living_stone"
    tags: ["armored", "guardian", "ancient"]
    state: "vigilant"
    integrity: 100
    combat_stats:
      hp: 50
      str: 10
      def: 8
      initiative: 6
    resistances: ["blunt", "sharp"]
    weaknesses: ["magic", "acid"]
    triggers:
      on_approach: "combat_engage"
      on_defeat: "gate_access"
    d20_checks:
      persuade: {"difficulty": 20, "skill": "persuasion", "success": "peaceful_passage"}
      intimidate: {"difficulty": 18, "skill": "intimidation", "success": "scare_away"}
  collision: true
  friction: 0.9
  sprite_id: "guardian"
  metadata:
    guardian_type: "stone"
    alignment: "neutral"

# Animated Objects (Aesthetic Focus)
animated_flower:
  <<: *organic_base
  characteristics:
    <<: *organic_base.characteristics
    material: "flower_petals"
    tags: ["animated", "flora", "wind_sensitive", "decorative"]
    state: "swaying"
    integrity: 20
    triggers:
      on_touch: "pollen_release"
      on_wind: "sway_animation"
    d20_checks:
      examine: {"difficulty": 5, "skill": "nature", "success": "observe_pollen"}
      collect: {"difficulty": 8, "skill": "dexterity", "success": "gather_flower"}
      touch: {"difficulty": 3, "skill": "nature", "success": "feel_petals"}
    animation_frames:
      wind_sway: ["flower_frame_1", "flower_frame_2", "flower_frame_3"]
      frame_duration: 500
    visual_effects:
      pollen_particles: true
      color_shift: ["pink", "light_pink", "white"]
  collision: false
  friction: 0.1
  sprite_id: "flower_animated"
  metadata:
    flower_type: "wind_sway"
    pollen_count: 5
    sway_amplitude: 2
    aesthetic_style: "sonic_field"
